graph TB
    %% Frontend Layer
    subgraph "Frontend (Interface do UsuÃ¡rio)"
        UI[ğŸ–¥ï¸ React Web App]
        Mobile[ğŸ“± Mobile App - Futuro]
        PWA[ğŸŒ PWA - Futuro]
    end

    %% API Gateway Layer
    subgraph "API Layer"
        Gateway[ğŸšª API Gateway<br/>FastAPI]
        Auth[ğŸ” Authentication<br/>Middleware]
        Rate[âš¡ Rate Limiting]
    end

    %% Core Services Layer
    subgraph "Core Services (MVP)"
        ChatAPI[ğŸ’¬ Chat Service<br/>FastAPI]
        SessionMgr[ğŸ“ Session Manager]
        ActivityMgr[ğŸ¯ Activity Manager<br/>Context Switching]
    end

    %% LangFlow Orchestration
    subgraph "LangFlow Engine"
        LF[ğŸ”„ LangFlow Server]
        
        subgraph "Pipelines"
            RAGFlow[ğŸ“š RAG Pipeline<br/>Query â†’ Embed â†’ Search â†’ LLM]
            ChatFlow[ğŸ’­ Chat Pipeline<br/>Context â†’ Prompt â†’ LLM]
            CodeFlow[ğŸ‘¨â€ğŸ’» Code Analysis<br/>Specialized Pipeline]
            BrainFlow[ğŸ§  Brainstorm<br/>Creative Pipeline]
        end
        
        Components[ğŸ§© Custom Components]
    end

    %% LLM Processing
    subgraph "LLM Layer (Local)"
        Ollama[ğŸ¤– Ollama Server]
        
        subgraph "Models"
            Llama[ğŸ¦™ Llama 3.1/3.2]
            CodeLlama[ğŸ’» Code Llama]
            Mistral[âš¡ Mistral]
        end
        
        LoadBalancer[âš–ï¸ Load Balancer<br/>Futuro]
    end

    %% Data Layer
    subgraph "Data Storage"
        subgraph "Vector Database"
            ChromaMVP[ğŸ” Chroma DB<br/>MVP - Local]
            PineconeCloud[â˜ï¸ Pinecone<br/>ProduÃ§Ã£o]
            DataStax[ğŸ—ƒï¸ DataStax Astra<br/>ProduÃ§Ã£o]
        end
        
        subgraph "Relational Database"
            SQLiteMVP[ğŸ“¦ SQLite<br/>MVP]
            PostgresProd[ğŸ˜ PostgreSQL<br/>ProduÃ§Ã£o]
        end
        
        subgraph "Cache Layer"
            RedisCache[ğŸš€ Redis<br/>Sessions & Cache]
        end
    end

    %% Document Processing
    subgraph "Document Pipeline"
        DocUpload[ğŸ“„ Document Upload]
        TextExtract[ğŸ“ Text Extraction]
        Chunking[âœ‚ï¸ Text Chunking]
        Embedding[ğŸ”¢ Embedding Generation]
        VectorStore[ğŸ’¾ Vector Storage]
    end

    %% Monitoring & Infrastructure
    subgraph "Infrastructure (ProduÃ§Ã£o)"
        Docker[ğŸ³ Docker Containers]
        K8s[â˜¸ï¸ Kubernetes]
        Monitor[ğŸ“Š Monitoring<br/>Prometheus + Grafana]
        Logs[ğŸ“‹ Centralized Logs<br/>ELK Stack]
    end

    %% User Interactions
    User[ğŸ‘¤ UsuÃ¡rio] --> UI
    User --> Mobile
    User --> PWA

    %% Frontend to API
    UI --> Gateway
    Mobile --> Gateway
    PWA --> Gateway

    %% API Gateway Flow
    Gateway --> Auth
    Gateway --> Rate
    Gateway --> ChatAPI

    %% Core Services Integration
    ChatAPI --> SessionMgr
    ChatAPI --> ActivityMgr
    ChatAPI --> LF

    %% LangFlow Orchestration
    LF --> RAGFlow
    LF --> ChatFlow
    LF --> CodeFlow
    LF --> BrainFlow
    LF --> Components

    %% LLM Integration
    RAGFlow --> Ollama
    ChatFlow --> Ollama
    CodeFlow --> Ollama
    BrainFlow --> Ollama

    %% Ollama Models
    Ollama --> Llama
    Ollama --> CodeLlama
    Ollama --> Mistral

    %% Vector Database Flow
    RAGFlow --> ChromaMVP
    RAGFlow --> PineconeCloud
    RAGFlow --> DataStax

    %% Relational Database
    SessionMgr --> SQLiteMVP
    SessionMgr --> PostgresProd
    ActivityMgr --> SQLiteMVP
    ActivityMgr --> PostgresProd

    %% Cache Integration
    ChatAPI --> RedisCache
    SessionMgr --> RedisCache

    %% Document Processing Flow
    DocUpload --> TextExtract
    TextExtract --> Chunking
    Chunking --> Embedding
    Embedding --> VectorStore
    VectorStore --> ChromaMVP
    VectorStore --> PineconeCloud

    %% Production Infrastructure
    Docker -.-> K8s
    K8s -.-> Monitor
    K8s -.-> Logs

    %% Styling
    classDef mvp fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef prod fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef core fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px
    classDef data fill:#fff3e0,stroke:#ef6c00,stroke-width:2px

    class ChromaMVP,SQLiteMVP mvp
    class PineconeCloud,DataStax,PostgresProd,LoadBalancer,Mobile,PWA,K8s,Monitor,Logs prod
    class LF,Ollama,ChatAPI core
    class ChromaMVP,PineconeCloud,DataStax,SQLiteMVP,PostgresProd,RedisCache data